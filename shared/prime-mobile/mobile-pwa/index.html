<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0f0f23">
  <meta name="description" content="PRIME Mobile â€” Manage your AI sessions from anywhere">
  <title>PRIME Mobile</title>

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/icon-192.png">

  <!-- Styles -->
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div id="app">
    <!-- Login Screen -->
    <div id="screen-login" class="screen active">
      <div class="login-container">
        <div class="login-logo">
          <h1>PRIME</h1>
          <p class="subtitle">Mobile Command</p>
        </div>
        <button id="btn-login" class="btn btn-primary btn-large" onclick="auth.login()">
          Sign in with Google
        </button>
        <button id="btn-dev-login" class="btn btn-secondary" onclick="auth.devLogin()" style="display:none;">
          Dev Login
        </button>
        <p class="login-note">Single-user: stephen@bender23.com</p>
      </div>
    </div>

    <!-- Dashboard Screen -->
    <div id="screen-dashboard" class="screen">
      <header class="app-header">
        <h2>Dashboard</h2>
        <div class="header-stats">
          <span id="total-unread" class="badge badge-urgent">0</span>
          <span class="label">unread</span>
        </div>
      </header>
      <div class="content">
        <div id="deadlines-banner" class="deadlines-banner" style="display:none;">
          <h3>Upcoming Deadlines</h3>
          <div id="deadlines-list"></div>
        </div>
        <div id="sessions-grid" class="sessions-grid">
          <!-- Session cards inserted by JS -->
          <div class="loading">Loading sessions...</div>
        </div>
      </div>
    </div>

    <!-- Inbox Screen -->
    <div id="screen-inbox" class="screen">
      <header class="app-header">
        <h2>Inbox</h2>
        <div class="header-actions">
          <select id="inbox-filter" onchange="inbox.filter(this.value)">
            <option value="active">Active</option>
            <option value="NEW">NEW only</option>
            <option value="ACKNOWLEDGED">Acknowledged</option>
            <option value="all">All</option>
          </select>
        </div>
      </header>
      <div class="content">
        <div id="inbox-messages" class="message-list">
          <div class="loading">Loading messages...</div>
        </div>
        <button class="fab" onclick="inbox.showCompose()">+</button>
      </div>
    </div>

    <!-- Chat Screen -->
    <div id="screen-chat" class="screen">
      <header class="app-header">
        <h2>Chat</h2>
        <div class="header-actions">
          <select id="chat-scope" class="chat-scope-select">
            <option value="all">All PRIME</option>
            <option value="athena">Athena</option>
            <option value="atlas">Atlas</option>
            <option value="google">Google</option>
            <option value="sketchi">Sketchi</option>
            <option value="semper">Semper</option>
          </select>
          <select id="chat-provider" class="chat-provider-select">
            <option value="claude">Claude</option>
            <option value="gemini">Gemini</option>
          </select>
        </div>
      </header>
      <div class="chat-container">
        <div id="chat-messages" class="chat-messages">
          <div class="chat-welcome">
            <p>Chat with Claude or Gemini with full PRIME context.</p>
            <p class="hint">Select scope above to focus on a specific session.</p>
          </div>
        </div>
        <div class="chat-input-area">
          <textarea id="chat-input" placeholder="Ask about your sessions..." rows="1" onkeydown="chat.handleKey(event)"></textarea>
          <button class="btn-send" onclick="chat.send()">
            <span>&#9654;</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Usage Screen -->
    <div id="screen-usage" class="screen">
      <header class="app-header">
        <h2>Usage</h2>
        <div class="header-actions">
          <button class="btn btn-small" onclick="usage.load()">Refresh</button>
        </div>
      </header>
      <div class="content" id="usage-content">
        <!-- Header Cards -->
        <div class="usage-cards">
          <div class="usage-card">
            <div class="usage-card-value" id="usage-cost-mtd">$0.00</div>
            <div class="usage-card-label">Cost (MTD)</div>
          </div>
          <div class="usage-card">
            <div class="usage-card-value" id="usage-tokens-mtd">0</div>
            <div class="usage-card-label">Tokens (MTD)</div>
          </div>
          <div class="usage-card">
            <div class="usage-card-value" id="usage-providers">0</div>
            <div class="usage-card-label">Providers</div>
          </div>
        </div>

        <!-- Charts -->
        <div class="usage-charts">
          <div class="usage-chart-box">
            <h3>Daily Cost (30 days)</h3>
            <div class="chart-container">
              <canvas id="usage-daily-chart"></canvas>
            </div>
          </div>
          <div class="usage-chart-box usage-chart-small">
            <h3>By Provider</h3>
            <div class="chart-container chart-container-small">
              <canvas id="usage-provider-chart"></canvas>
            </div>
          </div>
        </div>

        <!-- Recent Calls Table -->
        <div class="usage-table-wrap">
          <h3>Recent Calls</h3>
          <div class="usage-table-scroll">
            <table class="usage-table">
              <thead>
                <tr>
                  <th>Time</th>
                  <th>Provider</th>
                  <th>Model</th>
                  <th>Task</th>
                  <th>Tokens</th>
                  <th>Cost</th>
                </tr>
              </thead>
              <tbody id="usage-recent-body">
                <tr><td colspan="6" style="text-align:center;color:var(--text-muted)">Loading...</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <!-- Files Screen -->
    <div id="screen-files" class="screen">
      <header class="app-header">
        <h2>Files</h2>
        <div class="header-actions">
          <button class="btn btn-small" onclick="files.goHome()">Home</button>
        </div>
      </header>
      <div class="content">
        <nav id="file-breadcrumbs" class="breadcrumbs"></nav>
        <div id="file-list" class="file-list">
          <div class="loading">Loading files...</div>
        </div>
        <div id="file-viewer" class="file-viewer" style="display:none;">
          <div class="file-viewer-header">
            <span id="file-viewer-name"></span>
            <button class="btn btn-small" onclick="files.closeViewer()">Close</button>
          </div>
          <pre id="file-viewer-content"></pre>
        </div>
      </div>
    </div>

    <!-- Compose Modal -->
    <div id="modal-compose" class="modal" style="display:none;">
      <div class="modal-content">
        <h3>New Message</h3>
        <label>To:</label>
        <select id="compose-to">
          <option value="athena">Athena</option>
          <option value="8901">8901 Theory</option>
          <option value="8902">8902 COI</option>
          <option value="jado">JADO</option>
          <option value="atlas">Atlas</option>
          <option value="google">Google</option>
          <option value="sketchi">Sketchi</option>
          <option value="semper">Semper</option>
          <option value="fsmao">FSMAO</option>
          <option value="index">Index</option>
          <option value="historian">Historian</option>
        </select>
        <label>Priority:</label>
        <select id="compose-priority">
          <option value="Normal">Normal</option>
          <option value="High">High</option>
          <option value="Urgent">Urgent</option>
        </select>
        <label>Subject:</label>
        <input type="text" id="compose-subject" placeholder="Message subject">
        <label>Message:</label>
        <textarea id="compose-body" rows="6" placeholder="Write your message..."></textarea>
        <div class="modal-actions">
          <button class="btn btn-secondary" onclick="inbox.hideCompose()">Cancel</button>
          <button class="btn btn-primary" onclick="inbox.sendMessage()">Send</button>
        </div>
      </div>
    </div>

    <!-- Quick Actions Modal -->
    <div id="modal-actions" class="modal" style="display:none;" onclick="if(event.target===this) dashboard.hideActions()">
      <div class="modal-content modal-actions-content">
        <div class="modal-actions-header">
          <h3>Quick Actions</h3>
          <span id="actions-session-name" class="actions-target"></span>
        </div>
        <div id="actions-list" class="actions-list">
          <!-- Action buttons inserted by JS -->
        </div>
        <div class="modal-actions">
          <button class="btn btn-secondary" onclick="dashboard.hideActions()">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Bottom Navigation -->
    <nav id="bottom-nav" class="bottom-nav" style="display:none;">
      <button class="nav-btn active" data-screen="dashboard" onclick="navigate('dashboard')">
        <span class="nav-icon">&#9635;</span>
        <span class="nav-label">Dashboard</span>
      </button>
      <button class="nav-btn" data-screen="inbox" onclick="navigate('inbox')">
        <span class="nav-icon">&#9993;</span>
        <span class="nav-label">Inbox</span>
        <span id="nav-inbox-badge" class="nav-badge" style="display:none;">0</span>
      </button>
      <button class="nav-btn" data-screen="chat" onclick="navigate('chat')">
        <span class="nav-icon">&#9881;</span>
        <span class="nav-label">Chat</span>
      </button>
      <button class="nav-btn" data-screen="usage" onclick="navigate('usage')">
        <span class="nav-icon">&#9636;</span>
        <span class="nav-label">Usage</span>
      </button>
      <button class="nav-btn" data-screen="files" onclick="navigate('files')">
        <span class="nav-icon">&#128193;</span>
        <span class="nav-label">Files</span>
      </button>
    </nav>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
  <script src="js/api.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/dashboard.js"></script>
  <script src="js/inbox.js"></script>
  <script src="js/chat.js"></script>
  <script src="js/usage.js"></script>
  <script src="js/files.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
